{"version":3,"file":"js/811.4b093858.js","mappings":"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","sources":["webpack://just_sell/./src/modules/points/api/points.api.ts","webpack://just_sell/./src/modules/points/store/points.store.ts","webpack://just_sell/./src/modules/points/ui/PointsTable.vue?7166","webpack://just_sell/./src/modules/points/ui/PointsTable.vue","webpack://just_sell/./src/modules/points/ui/AddPointButton.vue?75c6","webpack://just_sell/./src/modules/points/ui/AddPointButton.vue","webpack://just_sell/./src/modules/points/pages/PointsListPage.vue?f77b","webpack://just_sell/./src/modules/points/pages/PointsListPage.vue"],"sourcesContent":["import { http } from \"@/api/client\";\nimport { AddPointsRequest, PointsRequest } from \"../model/points-request\";\nimport { ApiRoutes } from \"@/api/routes\";\nimport { sign, signArray } from \"@/api/crypto/DeffiHellman\";\nimport { getToken } from \"@/api/crypto/token\";\n\nexport const getPoints = async () => {\n  const { data } = await http.get(ApiRoutes.GET_POINTS);\n\n  return data;\n};\n\nexport const uploadFiscalKey = async (request: PointsRequest) => {\n  const signedPayload = {\n    ...request,\n    sign: await sign(\n      { fiscal_name: request.fiscal_name, fiscal_pass: request.fiscal_pass },\n      getToken()\n    ),\n  };\n\n  const { data } = await http.postForm(\n    ApiRoutes.UPLOAD_FISCAL_KEY,\n    signedPayload\n  );\n\n  return data;\n};\n\nexport const createPointsWithIds = async (request: AddPointsRequest) => {\n  const payloadForSign = request.points.map((point) => ({\n    chief_of_point: point.chief_of_point,\n    chief_phone: point.chief_phone,\n    close_day: point.close_day,\n    close_time: point.close_time,\n  }));\n\n  const signedPayload = {\n    ...request,\n    sign: await signArray(payloadForSign, getToken()),\n  };\n\n  const { data } = await http.post(ApiRoutes.ADD_POINT, signedPayload);\n\n  return data;\n};\n","import { defineStore } from \"pinia\";\nimport {\n  createPointsWithIds,\n  getPoints,\n  uploadFiscalKey,\n} from \"../api/points.api\";\nimport { AddPointsRequest, PointsRequest } from \"../model/points-request\";\n\nimport router from \"@/app/router\";\nimport { Point, PointRecord } from \"../model/point\";\n\nexport const usePointsStore = defineStore(\"points\", {\n  state: () => ({\n    loading: false,\n    pointsByKey: [] as Point[],\n    points: [] as PointRecord[],\n  }),\n\n  actions: {\n    async getPoints() {\n      this.loading = true;\n      const reponse = await getPoints();\n\n      if (reponse.code === 0) {\n        this.points = reponse.data?.map((point) => ({\n          ...point,\n          is_fiscal: point.is_fiscal\n            ? JSON.parse(point.is_fiscal)\n              ? \"Так\"\n              : \"Ні\"\n            : \"\",\n          is_test: point.is_test\n            ? JSON.parse(point.is_test)\n              ? \"Так\"\n              : \"Ні\"\n            : \"\",\n          subRows: [\n            {\n              ID: point.id,\n              Назва: point.POINT_NAME,\n              Адреса: point.POINT_ADDRESS,\n            },\n          ],\n        }));\n      }\n\n      this.loading = false;\n    },\n\n    async uploadFiscalKey(request: PointsRequest) {\n      const reponse = await uploadFiscalKey(request);\n\n      if (reponse.code === 0) {\n        this.pointsByKey = reponse.data;\n        router.push({ name: \"fiscalAdd\" });\n      }\n    },\n\n    async craetePoints(request: AddPointsRequest) {\n      const reponse = await createPointsWithIds(request);\n\n      if (reponse.code === 0) {\n        this.pointsByKey = reponse.data;\n      }\n    },\n  },\n});\n","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { createColumnHelper } from \"@tanstack/vue-table\";\nimport { expandedButton } from \"@/components/table/ExpandedButton\";\n\nimport { PointRecord } from \"../model/point\";\n\n\nimport { defineComponent } from \"vue\";\nimport VTable from \"@/components/table/VTable.vue\";\n\nconst __default__ = defineComponent({\n  components: {\n    VTable,\n  },\n});\n\ninterface PointsTableProps {\n  data: PointRecord[];\n  empty: boolean;\n  total: number;\n}\n\n\nexport default /*#__PURE__*/_defineComponent({\n  ...__default__,\n  __name: 'PointsTable',\n  props: {\n    data: {},\n    empty: { type: Boolean },\n    total: {}\n  },\n  setup(__props: any) {\n\nconst columnHelper = createColumnHelper<PointRecord>();\n\nconst columns = [\n  columnHelper.accessor(\"id\", {\n    cell: (info) => {\n      const value = info.getValue();\n      const isExpanded = info.row.getIsExpanded();\n      const onClick = info.row.getToggleExpandedHandler();\n      return expandedButton(value, isExpanded, onClick);\n    },\n    header: (props) => props.column.id,\n    sortDescFirst: true,\n  }),\n  columnHelper.accessor(\"POINT_NAME\", {\n    cell: (info) => info.getValue(),\n    header: \"Назва\",\n    sortDescFirst: true,\n  }),\n\n  columnHelper.accessor(\"FISCAL_NUM_PRRO\", {\n    header: \"ПРРО №\",\n    cell: (info) => info.getValue(),\n    sortDescFirst: true,\n  }),\n  columnHelper.accessor(\"auto_close\", {\n    header: \"Час закриття зміни\",\n    cell: (info) => info.getValue(),\n    sortDescFirst: true,\n  }),\n  columnHelper.accessor(\"auto_close_day_num\", {\n    header: \"Дні закриття зміни\",\n    cell: (info) => info.getValue(),\n    sortDescFirst: true,\n  }),\n  columnHelper.accessor(\"is_fiscal\", {\n    header: \"Чи фіскальна\",\n    cell: (info) => info.getValue(),\n    sortDescFirst: true,\n  }),\n  columnHelper.accessor(\"is_test\", {\n    header: \"Чи тестова\",\n    cell: (info) => info.getValue(),\n    sortDescFirst: true,\n  }),\n];\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(VTable, {\n    data: _ctx.data,\n    columns: columns,\n    empty: _ctx.empty,\n    total: _ctx.total\n  }, null, 8, [\"data\", \"empty\", \"total\"]))\n}\n}\n\n})","import script from \"./PointsTable.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PointsTable.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createVNode as _createVNode, resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport VButton from \"@/components/buttons/BaseButton/BaseButton.vue\";\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'AddPointButton',\n  setup(__props) {\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_router_link = _resolveComponent(\"router-link\")!\n\n  return (_openBlock(), _createBlock(_component_router_link, {\n    to: { name: 'fiscalCreate' },\n    class: \"terminal-create-btn\"\n  }, {\n    default: _withCtx(() => [\n      _createVNode(VButton, { hasMaxWidth: false }, {\n        text: _withCtx(() => [\n          _createTextVNode(_toDisplayString(_ctx.$t(\"Додати точку\")), 1)\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./AddPointButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AddPointButton.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { computed, onMounted } from \"vue\";\nimport AppLayout from \"@/components/layout/AppLayout/AppLayout.vue\";\nimport AppLoading from \"@/components/layout/AppLoading/AppLoading.vue\";\n\nimport PointsTable from \"../ui/PointsTable.vue\";\nimport AddPointButton from \"../ui/AddPointButton.vue\";\n\nimport { usePointsStore } from \"../store/points.store\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'PointsListPage',\n  setup(__props) {\n\nconst pointsStore = usePointsStore();\nconst points = computed(() => pointsStore.points);\nconst loading = computed(() => pointsStore.loading);\n\nonMounted(() => {\n  pointsStore.getPoints();\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(AppLayout, null, {\n    appLoading: _withCtx(() => [\n      _createVNode(AppLoading, { loading: loading.value }, null, 8, [\"loading\"])\n    ]),\n    appTitle: _withCtx(() => [\n      _createTextVNode(_toDisplayString(_ctx.$t(\"Точки\")), 1)\n    ]),\n    appExtra: _withCtx(() => [\n      _createVNode(AddPointButton)\n    ]),\n    appContent: _withCtx(() => [\n      _createVNode(PointsTable, {\n        data: points.value,\n        empty: !points.value?.length,\n        total: points.value?.length\n      }, null, 8, [\"data\", \"empty\", \"total\"])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./PointsListPage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PointsListPage.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["getPoints","async","data","http","ApiRoutes","uploadFiscalKey","signedPayload","request","sign","fiscal_name","fiscal_pass","getToken","createPointsWithIds","payloadForSign","points","map","point","chief_of_point","chief_phone","close_day","close_time","signArray","usePointsStore","defineStore","state","loading","pointsByKey","actions","this","reponse","code","is_fiscal","JSON","parse","is_test","subRows","ID","id","Назва","POINT_NAME","Адреса","POINT_ADDRESS","router","name","__default__","defineComponent","components","VTable","_defineComponent","__name","props","empty","type","Boolean","total","setup","__props","columnHelper","createColumnHelper","columns","accessor","cell","info","value","getValue","isExpanded","row","getIsExpanded","onClick","getToggleExpandedHandler","expandedButton","header","column","sortDescFirst","_ctx","_cache","_openBlock","_createBlock","__exports__","_component_router_link","_resolveComponent","to","class","default","_withCtx","_createVNode","VButton","hasMaxWidth","text","_createTextVNode","_toDisplayString","$t","_","pointsStore","computed","onMounted","AppLayout","appLoading","AppLoading","appTitle","appExtra","AddPointButton","appContent","PointsTable","length"],"sourceRoot":""}