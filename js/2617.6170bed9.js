"use strict";(self["webpackChunkjust_sell"]=self["webpackChunkjust_sell"]||[]).push([[2617],{2729:function(e,t,l){l.d(t,{Z:function(){return h}});var a=l(3396),s=l(7139),i=l(9167);const o=["checked","name","disabled"],n={key:0,for:"#checkbox-field",class:"checkbox-field__label"},r={id:"checkbox-field",class:"checkbox-field__box"},d={key:0,src:i,alt:"Checked"},c={key:0,class:"form-field__error"},u=(0,a.aZ)({emits:["change","update:modelValue"],data(){return{checked:this.$props.modelValue}},computed:{hasError(){return Boolean(this.$props.error)}},watch:{modelValue:{handler(e){this.checked="string"===typeof e?JSON.parse(e):e},immediate:!0}},methods:{check(){this.checked=!this.checked,this.$emit("change",this.checked),this.$emit("update:modelValue",this.checked)}}});var m=(0,a.aZ)({...u,__name:"CheckboxField",props:{name:{},label:{},defaultChecked:{type:Boolean},direction:{default:"right"},variant:{default:"primary"},size:{default:"md"},modelValue:{type:Boolean},disabled:{},error:{},justify:{default:"space-between"}},setup(e){return(e,t)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("input",{type:"checkbox",class:"checkbox-field__input",checked:e.modelValue||e.checked,name:e.name,disabled:e.disabled},null,8,o),(0,a._)("div",{class:(0,s.C_)(["checkbox-field",{"checkbox-field--checked":e.checked,"checkbox-field--disabled":e.disabled,[`checkbox-field--${e.direction}`]:!0,[`checkbox-field--${e.variant}`]:!0,[`checkbox-field--${e.size}`]:!0}]),style:(0,s.j5)({justifyContent:"space-between"===e.justify?"space-between":"flex-start"}),onClick:t[0]||(t[0]=(...t)=>e.check&&e.check(...t))},[Boolean(e.label)?((0,a.wg)(),(0,a.iD)("label",n,(0,s.zw)(e.$t(e.label)),1)):(0,a.kq)("",!0),(0,a._)("div",r,[e.checked?((0,a.wg)(),(0,a.iD)("img",d)):(0,a.kq)("",!0)])],6),e.hasError?((0,a.wg)(),(0,a.iD)("div",c,(0,s.zw)(e.error),1)):(0,a.kq)("",!0)],64))}});const p=m;var h=p},6887:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(3396);function s(e,t,l,s,i,o){const n=(0,a.up)("select-field"),r=(0,a.up)("form-field");return(0,a.wg)(),(0,a.j4)(r,{label:"Компанії"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{options:e.companies,name:"companies","input-placeholder":"Оберіть компанію","search-placeholder":"Введіть компанію","has-search":!1,"model-value":e.modelValue,"onUpdate:modelValue":e.select,size:"sm",disabled:e.disabled},null,8,["options","model-value","onUpdate:modelValue","disabled"])])),_:1})}l(541);var i=l(4560),o=l(2946),n=(0,a.aZ)({props:{modelValue:String,small:{type:Boolean,required:!1},disabled:{required:!1}},emits:["update:modelValue","blur"],components:{FormField:i.Z,SelectField:o.Z},computed:{companies(){const e=this.$store.state.terminals.terminalsRef;if(!e)return[];const t=e.parent_child.map((e=>({value:e.id.toString(),label:e.name||""})));return t.unshift({value:"",label:"Не обрано"}),t}},methods:{select(e){this.$emit("update:modelValue",e),this.$emit("blur",e)}}}),r=l(89);const d=(0,r.Z)(n,[["render",s]]);var c=d},2619:function(e,t,l){l.d(t,{Z:function(){return d}});var a=l(3396),s=l(7139);const i=["type","placeholder","name","required","value","disabled"],o=(0,a.aZ)({emits:["update:modelValue","blur"],methods:{input(e){const t=e.target?.value;this.$emit("update:modelValue",t)}}});var n=(0,a.aZ)({...o,__name:"InputField",props:{name:{},type:{},placeholder:{},required:{type:Boolean},size:{default:"lg"},variant:{default:"default"},modelValue:{},disabled:{}},setup(e){return(e,t)=>((0,a.wg)(),(0,a.iD)("input",{type:e.type,placeholder:e.placeholder?e.$t(e.placeholder):"",name:e.name,required:e.required,class:(0,s.C_)([`form-field__input--${e.size} form-field__input--${e.variant}`,"form-field__input"]),value:e.modelValue,disabled:e.disabled,onInput:t[0]||(t[0]=t=>e.input(t)),onBlur:t[1]||(t[1]=t=>e.$emit("blur"))},null,42,i))}});const r=n;var d=r},8503:function(e,t,l){l.d(t,{Z:function(){return m}});var a=l(3396),s=l(7139),i=l(2729);const o={class:"select-field__item-value"},n={class:"select-field__item-content"},r={class:"select-field__item-hint"},d=(0,a.aZ)({emits:["select"],components:{CheckboxField:i.Z},data(){return{selected:this.checked}},watch:{checked:{handler(e){this.selected=e},immediate:!0}}});var c=(0,a.aZ)({...d,__name:"OptionItemWithCheckbox",props:{option:{},checked:{type:Boolean}},setup(e){return(e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"select-field__item",onClick:t[1]||(t[1]=t=>e.$emit("select",e.option))},[(0,a._)("div",o,[(0,a.Wm)(i.Z,{name:"",modelValue:e.selected,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selected=t),label:e.option.label,direction:"left",size:"sm"},null,8,["modelValue","label"]),(0,a._)("div",n,[(0,a._)("span",r,(0,s.zw)(e.option.hint),1)])])]))}});const u=c;var m=u},5071:function(e,t,l){l.d(t,{Z:function(){return h}});var a=l(3396),s=l(7139),i=l(9242),o=l(5572),n=l(8445),r=l(8503);const d=["name"],c={class:"select-field__dropdown"},u=(0,a.aZ)({emits:["update:modelValue"],components:{SearchInput:o.Z,SelectedInput:n.Z,OptionItem:r.Z},data(){return{opened:!1,value:this.modelValue||"",selectedLabel:"",selected:[]}},mounted(){document.addEventListener("keydown",this.onEscapePressed)},beforeUnmount(){document.removeEventListener("keydown",this.onEscapePressed)},watch:{selected(){this.value=this.selected?.label||""},options(){this.selectedLabel=this.setSelectedLabel(this.modelValue)},modelValue:{handler(e){this.selectedLabel=this.setSelectedLabel(e)},immediate:!0}},methods:{open(){this.opened=!0},toggle(){this.opened=!this.opened},close(){this.opened=!1},select(e){this.selected.some((t=>e.value===t))?this.selected=this.selected.filter((t=>t!=e.value)):this.selected=[...this.selected,e.value],this.selectedLabel=this.setSelectedLabel(this.selected),this.$emit("update:modelValue",this.selected)},clear(){this.value=""},onEscapePressed(e){"Escape"===e.key&&this.close()},setSelectedLabel(e=[]){if(!e)return"";const t=Array.isArray(e)?e:[e],l=this.options.filter((({value:e})=>t.some((t=>t==e)))).map((e=>e.label));return l.join(",")}}});var m=(0,a.aZ)({...u,__name:"SelectFieldMultiple",props:{name:{},options:{},inputPlaceholder:{},searchPlaceholder:{},hasSearch:{type:Boolean,default:!0},modelValue:{},disabled:{},size:{default:"md"}},setup(e){return(e,t)=>{const l=(0,a.Q2)("click-outside");return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:(0,s.C_)(["select-field",{"select-field--active":e.opened,"select-field--disabled":e.disabled}]),ref:"selectField"},[(0,a._)("input",{type:"text",name:e.name,class:"select-input-hidden"},null,8,d),(0,a._)("div",{class:(0,s.C_)(["select-field__container form-field__input",`form-field__input--${e.size}`]),onClick:t[0]||(t[0]=t=>e.hasSearch?e.open():e.toggle())},[(0,a.wy)((0,a.Wm)(n.Z,{label:e.selectedLabel,placeholder:e.$t(e.inputPlaceholder||"Select")},null,8,["label","placeholder"]),[[i.F8,!e.hasSearch||!e.opened]]),(0,a.wy)((0,a.Wm)(o.Z,{placeholder:e.$t(e.searchPlaceholder||"Search"),onClear:e.clear,name:e.name},null,8,["placeholder","onClear","name"]),[[i.F8,e.opened&&e.hasSearch]])],2),(0,a._)("div",c,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options,(t=>((0,a.wg)(),(0,a.j4)(r.Z,{key:t.value,option:t,checked:e.selected?.some((e=>e.value==t.value)),onSelect:e.select},null,8,["option","checked","onSelect"])))),128))])],2)),[[l,e.close]])}}});const p=m;var h=p},3377:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(3396),s=l(7139);const i={class:"form-title__content"};function o(e,t,l,o,n,r){return(0,a.wg)(),(0,a.iD)("div",{class:(0,s.C_)(["form-title",`form-title--${e.direction}`])},[(0,a._)("div",i,[(0,a.WI)(e.$slots,"title")])],2)}var n=(0,a.aZ)({props:{direction:{type:String,required:!1,default:"bottom"}}}),r=l(89);const d=(0,r.Z)(n,[["render",o]]);var c=d},6931:function(e,t,l){l.d(t,{Z:function(){return h}});var a=l(3396),s=l(7139),i=l(9242);function o(e,t,l,o,n,r){return(0,a.wg)(),(0,a.iD)("form",{class:(0,s.C_)(e.classNames),onSubmit:[t[0]||(t[0]=(0,i.iM)((()=>{}),["prevent"])),t[1]||(t[1]=(0,i.iM)((()=>{}),["stop"])),t[2]||(t[2]=(...t)=>e.onSubmit&&e.onSubmit(...t))]},[(0,a.WI)(e.$slots,"fields",{values:e.values,errors:e.errors,hasErrors:e.hasErrors,validateAt:e.validateAt,ref:"slot"})],34)}var n=l(8086),r=l.n(n);const d=async(e,t)=>{let l={};try{await t.validate(e,{abortEarly:!1}),l={}}catch(a){a.inner.forEach((e=>{const t=e.path,a=e.message;r()(l,t,a)}))}return l},c=async(e,t,l)=>{let a="";try{await l.validateAt(e,t)}catch(s){a=s.message}return a};var u=(0,a.aZ)({emits:["submit"],props:{classNames:{type:String,required:!1},initialValues:{type:Object,required:!0},schema:{required:!1}},data(){return{values:this.initialValues,errors:{}}},computed:{hasErrors(){return Boolean(Object.keys(this.errors).length>0)}},watch:{initialValues(e){this.values=e},errors(e){const t=Object.keys(e)[0],l=document.querySelector(`[name="${t}"]`);if(!l)return;const a=20,s=l.getBoundingClientRect().top-a;window.scrollTo({top:s}),l.focus()}},methods:{async onSubmit(){const e=await this.validate();e&&this.$emit("submit",this.values)},async validate(){return this.schema?(this.errors=await d(this.values,this.schema),Boolean(Object.keys(this.errors).length<=0)):(console.error("Validation schema doen't provided"),!0)},async validateAt(e){if(!this.schema)return console.error("Validation schema doen't provided"),!0;const t=await c(e,this.values,this.schema);r()(this.errors,e,t)}}}),m=l(89);const p=(0,m.Z)(u,[["render",o]]);var h=p},9983:function(e,t,l){l.d(t,{Z:function(){return u}});var a=l(3396),s=l(9242);const i={class:"tab-pane"};function o(e,t,l,o,n,r){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",i,[(0,a.WI)(e.$slots,"default")],512)),[[s.F8,o.isActive]])}var n=l(4870),r={props:["title"],setup(e){const t=(0,n.iH)(!1),l=(0,a.f3)("TabsProvider");return(0,a.YP)((()=>l.selectedIndex),(()=>{t.value=e.title===l.selectedIndex})),(0,a.wF)((()=>{t.value=e.title===l.selectedIndex})),{isActive:t}}},d=l(89);const c=(0,d.Z)(r,[["render",o]]);var u=c},6890:function(e,t,l){l.d(t,{Z:function(){return h}});var a=l(3396),s=l(7139);const i={class:"tabs"},o={class:"tabs-pills"},n=["onClick"],r={class:"tabs-panes"};function d(e,t,l,d,c,u){return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("div",o,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.tabs,(t=>((0,a.wg)(),(0,a.iD)("div",{class:(0,s.C_)(["tab-pill",{active:e.selectedIndex===t.props.title}]),key:t.props.title,onClick:l=>e.selectTab(t.props.title)},(0,s.zw)(e.$t(t.props.title)),11,n)))),128))]),(0,a._)("div",r,[(0,a.WI)(e.$slots,"default")])])}var c=l(4870),u=(0,a.aZ)({setup(e,{slots:t,emit:l}){const s=(0,c.qj)({selectedIndex:null,tabs:[],count:0});(0,a.JJ)("TabsProvider",s);const i=e=>{s.selectedIndex=e,l("change",e)},o=()=>{t.default&&(s.tabs=t.default())};return(0,a.wF)((()=>o())),(0,a.Xn)((()=>o())),(0,a.bv)((()=>{i(s.tabs.at(0).props.title)})),{...(0,c.BK)(s),selectTab:i}}}),m=l(89);const p=(0,m.Z)(u,[["render",d]]);var h=p},1118:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(3396);function s(e,t,l,s,i,o){const n=(0,a.up)("select-field"),r=(0,a.up)("form-field");return(0,a.wg)(),(0,a.j4)(r,{label:e.label||"Термінали на які не поширюється знижка",error:e.error},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{options:e.terminals,name:"terminal","input-placeholder":"Оберіть термінал","search-placeholder":"Введіть назву терміналу","has-searh":"","model-value":e.modelValue,"onUpdate:modelValue":e.select},null,8,["options","model-value","onUpdate:modelValue"])])),_:1},8,["label","error"])}var i=l(4560),o=l(5071),n=(0,a.aZ)({props:{modelValue:String,error:String,label:{type:String,required:!1}},emits:["update:modelValue"],components:{FormField:i.Z,SelectField:o.Z},computed:{terminals(){return[{value:"1",label:"Terminal 1"},{value:"2",label:"Terminal 2"}]}},methods:{select(e){this.$emit("update:modelValue",e)}}}),r=l(89);const d=(0,r.Z)(n,[["render",s]]);var c=d},154:function(e,t,l){l.r(t),l.d(t,{default:function(){return E}});var a=l(3396),s=l(7139);function i(e,t,l,i,o,n){const r=(0,a.up)("app-loading"),d=(0,a.up)("loyalty-form"),c=(0,a.up)("app-layout");return(0,a.wg)(),(0,a.j4)(c,null,{appTitle:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Редагувати систему лояльності")),1)])),appContent:(0,a.w5)((()=>[(0,a.Wm)(r,{loading:e.loading},null,8,["loading"]),e.loading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(d,{key:0}))])),_:1})}var o=l(8231),n=l.p+"img/warn-icon.68b98705.svg";const r={class:"loyalty-form__description"},d=(0,a._)("img",{src:n,alt:""},null,-1),c={href:"#"},u={class:"loyalty-form"},m={class:"loyalty-form"},p={class:"checkbox-container"};function h(e,t,l,i,o,n){const h=(0,a.up)("input-field"),f=(0,a.up)("form-field"),v=(0,a.up)("terminals-select"),b=(0,a.up)("companies-select"),_=(0,a.up)("v-tab"),k=(0,a.up)("checkbox-field"),w=(0,a.up)("form-title"),y=(0,a.up)("v-tabs"),g=(0,a.up)("v-button"),Z=(0,a.up)("v-form");return(0,a.wg)(),(0,a.j4)(Z,{"class-names":"loyalty-form","initial-values":e.initialValues,onSubmit:e.submitLoyalty},{fields:(0,a.w5)((({values:t})=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{title:"Фіксована знижка"},{default:(0,a.w5)((()=>[(0,a._)("div",r,[d,(0,a._)("p",null,[(0,a.Uk)((0,s.zw)(e.$t("Даний тип знижки дає змогу додати до системи лояльності конкретні номери карт. Карти можна безпосередньо на будь якому терміналі системи JustSell. З інструкцією можете ознайомитись"))+" ",1),(0,a._)("a",c,(0,s.zw)(e.$t("тут")),1)])]),(0,a._)("div",u,[(0,a.Wm)(f,{label:"Введіть назву знижки"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{name:"name",placeholder:"Назва знижки"})])),_:1}),(0,a.Wm)(f,{label:"Введіть сумму для активації бонуса"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{placeholder:"Наприклад, 300"})])),_:1}),(0,a.Wm)(v),(0,a.Wm)(b)])])),_:1}),(0,a.Wm)(_,{title:"Динамічний бонус"},{default:(0,a.w5)((()=>[(0,a._)("div",m,[(0,a._)("div",p,[(0,a.Wm)(f,null,{hint:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Користувач накопичивши бонус на одному терміналі може використати його на будь якому іншому терміналі з вибраної групи")),1)])),default:(0,a.w5)((()=>[(0,a.Wm)(k,{modelValue:t.all_terms,"onUpdate:modelValue":e=>t.all_terms=e,name:"need_shift",label:"Єдиний бонус для всіх терміналів"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)]),t.all_terms?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(v,{key:0})),(0,a.Wm)(w,{direction:"top"},{title:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("За кількістю покупок")),1)])),_:1}),(0,a.Wm)(f,{label:"Кожен продаж безкоштовний"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{placeholder:"Наприклад, кожна 5-а безкоштовний"})])),_:1}),(0,a.Wm)(w,{direction:"top"},{title:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Бонус при покупці")),1)])),_:1}),(0,a.Wm)(f,{label:"Нараховується % від суми товару"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{placeholder:"Наприклад, 10%"})])),_:1}),(0,a.Wm)(f,{label:"Фіксований бонус"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{placeholder:"Наприклад, 400"})])),_:1})])])),_:2},1024)])),_:2},1024),(0,a._)("div",{class:(0,s.C_)(["form-actions",{"form-actions--fixed":e.actionsFixed}])},[e.canEdit?((0,a.wg)(),(0,a.j4)(g,{key:0,type:"button",loading:e.loading,onClick:e.sendConfig},{text:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Додати налаштування термінала")),1)])),_:1},8,["loading","onClick"])):(0,a.kq)("",!0),(0,a.Wm)(g,{type:"button",loading:e.loading,onClick:e.activeTerminal,fixed:""},{text:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Додати знижку")),1)])),_:1},8,["loading","onClick"])],2)])),_:1},8,["initial-values","onSubmit"])}var f=l(6931),v=l(9983),b=l(6890),_=l(4560),k=l(2619),w=l(2729),y=l(4610),g=l(3377),Z=l(1118),V=l(6887),$=l(4677);const S=e=>({id:e,all_terms:!1});var x=(0,a.aZ)({inject:["rules"],props:{actionsFixed:{type:Boolean,required:!1,default:!1}},components:{FormField:_.Z,FormTitle:g.Z,InputField:k.Z,VButton:y.Z,VForm:f.Z,VTab:v.Z,VTabs:b.Z,TerminalsSelect:Z.Z,CompaniesSelect:V.Z,CheckboxField:w.Z},setup(){const e=(0,$.pm)();return{toast:e}},data(){return{initialValues:S("")}},methods:{submitLoyalty(e){console.log(e)}}}),C=l(89);const W=(0,C.Z)(x,[["render",h]]);var F=W,j=l(7863),q=l(5384),z=(0,a.aZ)({components:{AppLayout:o.Z,AppLoading:j.Z,LoyaltyForm:F},computed:{loading(){return this.$store.state.terminals.loading}},mounted(){this.$store.dispatch(q.T.GET_TERMINALS_REF)}});const I=(0,C.Z)(z,[["render",i]]);var E=I},9167:function(e,t,l){e.exports=l.p+"img/check-icon.972bc3c4.svg"}}]);
//# sourceMappingURL=2617.6170bed9.js.map