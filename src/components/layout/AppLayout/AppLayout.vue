<template>
  <div class="app-layout">
    <app-navbar @mobileButtonClick="(value: boolean) => menuOpened = value" />
    <div class="app-layout__row">
      <app-sidebar :menuOpened="menuOpened" v-if="hasSidebar" />
      <div class="app-layout__content">
        <transition>
          <app-loading :loading="routeLoading" />
        </transition>
        <slot name="appLoading" />
        <div class="app-layout__header">
          <div class="app-layout__link" v-if="hasAppLink">
            <slot name="appLink"></slot>
          </div>
          <div class="app-layout__text" v-if="hasAppTitle">
            <h2 class="app-layout__title">
              <slot name="appTitle"></slot>
            </h2>
            <h4 class="app-layout__subtitle">
              <slot name="appSubtitle"></slot>
            </h4>
          </div>
          <div class="app-layout__extra">
            <slot name="appExtra"></slot>
          </div>
        </div>
        <slot name="appContent"></slot>
        <div class="app-layout__actions">
          <slot name="appActions"></slot>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { computed, ref, useSlots } from "vue";
import { useRouterStore } from "@/app/router/router.store";
import AppLoading from "../AppLoading/AppLoading.vue";
import AppNavbar from "../AppNavbar/AppNavbar.vue";
import AppSidebar from "../AppSidebar/AppSidebar.vue";

type AppLayoutProps = {
  hasSidebar?: boolean;
};

const props = withDefaults(defineProps<AppLayoutProps>(), {
  hasSidebar: true,
});
const slots = useSlots();
const routerStore = useRouterStore();

const menuOpened = ref(false);
const hasAppLink = computed(() => Boolean(slots.appLink));
const hasAppTitle = computed(() => Boolean(slots.appTitle));
const routeLoading = computed(() => Boolean(routerStore.loading));
</script>

<!-- <script lang="ts">
import { defineComponent } from "vue";

import AppLoading from "../AppLoading/AppLoading.vue";
import AppNavbar from "../AppNavbar/AppNavbar.vue";
import AppSidebar from "../AppSidebar/AppSidebar.vue";

export default defineComponent({
  props: {
    hasSidebar: {
      type: Boolean,
      default: true,
      required: false,
    },

  },
  components: {
    AppNavbar,
    AppSidebar,
    AppLoading,
  },

  data() {
    return {
      menuOpened: false,
    };
  },

  computed: {
    hasAppLink(): boolean {
      return Boolean(this.$slots.appLink);
    },
    hasAppTitle(): boolean {
      return Boolean(this.$slots.appTitle);
    },

    routeLoading(): boolean {
      return this.$store.state.router.loading;
    },
  },
});
</script> -->
